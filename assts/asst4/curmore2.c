/*------------------------------------------------------------
*	cmore.c -	curses-based random "more"  filter.  
* Display a text stream by filling it in on screen randomly.
* Written 3/30/98, TEK, after watching "Sneakers".
* Modified 10/23/98, TEK, to incorporate coords into source.
* Modified Fri May 24 2000, TEK, reworked logic, made 
* screen display more robust, allowed for multiple-screen
* display, convert tabs to spaces.
compile: gcc -o sneakers sneakers.c -lcurses
execute: sneakers [-] file  || process | sneakers [-]
the [-] turns on garbage, otherwise pgm fills a black screen.
NOTE: this won't work over the school LAN, which can't keep
up with Curses, and drops characters.  Run it on your own
system console.
Sun Jun 16 21:27:43 PDT 2002 begun modification to use getopt()
IAW GNU coding standards.
------------------------------------------------------------*/

#include <unistd.h>
#include <getopt.h>
#include <curses.h>
#include <sys/signal.h>
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>

#define SLEEPTIME 900

int 
main(argc, argv, env)
int argc; 
char *argv[]; 
char **env;

{
	void die(int) ;

int coords[4000] = {
2,70, 3,67, 17,55, 4,78, 0,79, 11,68, 1,58, 20,34, 10,3, 6,14, 7,39, 7,24, 3,44, 8,47, 17,15, 1,59, 24,16, 19,0, 20,52, 15,6, 9,72, 5,77, 18,16, 14,61, 0,39, 21,38, 24,46, 11,43, 0,16, 15,31, 21,51, 4,12, 8,8, 23,40, 19,60, 18,66, 9,58, 0,73, 3,6, 6,55, 19,75, 18,10, 19,1, 21,17, 23,52, 1,79, 3,18, 10,71, 3,21, 20,15, 24,29, 18,50, 8,61, 20,75, 10,16, 17,35, 12,54, 0,27, 23,73, 23,2, 19,7, 22,26, 8,16, 16,59, 16,51, 9,16, 20,12, 6,3, 1,65, 22,44, 21,30, 24,7, 23,67, 9,7, 5,62, 6,50, 18,38, 3,61, 19,77, 3,62, 13,26, 9,34, 7,53, 23,78, 7,22, 10,24, 5,58, 17,70, 9,1, 12,48, 20,40, 14,59, 12,20, 18,75, 16,33, 17,54, 4,34, 0,19, 7,61, 4,25, 24,27, 10,14, 12,22, 11,3, 9,66, 19,18, 18,69, 16,45, 7,52, 9,15, 20,44, 18,30, 10,73, 2,60, 8,59, 18,41, 19,8, 24,61, 14,42, 11,51, 4,54, 2,25, 0,32, 7,55, 23,63, 7,47, 7,2, 6,49, 4,39, 9,45, 8,5, 19,73, 6,37, 19,52, 0,67, 0,40, 17,59, 13,32, 17,5, 8,22, 24,69, 19,46, 15,38, 21,72, 17,68, 23,45, 10,59, 6,56, 4,1, 16,34, 21,32, 4,61, 18,65, 17,26, 18,23, 17,64, 21,16, 17,17, 16,35, 21,53, 23,39, 20,30, 5,2, 0,70, 7,10, 5,48, 20,43, 18,19, 18,11, 6,32, 20,60, 13,23, 23,21, 5,4, 3,73, 0,62, 13,18, 18,35, 21,15, 21,6, 18,76, 23,17, 1,37, 12,67, 5,68, 12,44, 6,33, 21,31, 11,57, 10,25, 0,13, 16,79, 7,73, 5,56, 14,3, 14,9, 14,26, 17,53, 12,59, 18,43, 12,51, 9,10, 23,60, 14,4, 5,39, 21,67, 8,79, 3,3, 4,63, 16,31, 23,76, 20,59, 13,65, 1,50, 22,55, 8,7, 8,56, 14,39, 10,17, 12,68, 20,46, 18,59, 19,42, 21,27, 6,71, 17,52, 3,17, 23,51, 24,6, 3,28, 22,8, 18,9, 5,44, 6,23, 9,73, 24,67, 18,72, 4,6, 23,70, 2,20, 14,77, 21,43, 16,14, 23,34, 2,19, 8,52, 15,54, 5,19, 3,16, 12,28, 10,0, 21,59, 17,14, 1,69, 10,42, 5,15, 1,68, 22,43, 2,58, 4,58, 8,42, 14,13, 17,57, 19,49, 4,36, 17,2, 3,47, 18,2, 13,0, 0,52, 0,6, 6,4, 19,33, 9,79, 14,49, 11,13, 15,76, 4,77, 2,15, 1,20, 16,62, 17,65, 4,44, 10,18, 7,31, 4,27, 11,31, 4,3, 1,70, 3,8, 5,5, 10,4, 19,10, 2,42, 5,10, 3,42, 2,73, 14,23, 8,66, 22,59, 3,9, 6,47, 10,33, 4,40, 9,39, 0,46, 13,48, 2,6, 7,32, 15,26, 14,27, 2,9, 1,48, 13,37, 12,30, 7,74, 23,46, 20,5, 11,9, 2,38, 22,3, 10,12, 3,33, 23,14, 4,21, 23,27, 22,73, 23,28, 12,40, 11,0, 23,48, 4,43, 4,7,
16,55, 1,9, 10,58, 17,25, 20,0, 16,39, 3,24, 14,78, 4,37, 1,60, 14,32, 22,54, 8,74, 1,10, 15,24, 20,9, 15,67, 4,60, 12,35, 9,11, 20,66, 14,79, 18,24, 10,45, 3,30, 12,52, 11,23, 18,5, 13,56, 22,53, 8,31, 6,77, 9,76, 9,26, 7,48, 19,48, 14,5, 8,30, 10,60, 16,61, 0,24, 11,37, 17,4, 18,33, 16,21, 3,63, 10,40, 2,7, 11,67, 23,62, 10,8, 12,15, 10,66, 24,34, 11,34, 16,8, 17,1, 15,40, 23,23, 20,41, 8,43, 0,69, 21,45, 2,10, 1,43, 21,13, 10,77, 24,78, 3,64, 10,1, 6,61, 20,27, 3,11, 22,19, 23,5, 12,26, 17,16, 22,57, 11,78, 21,71, 9,60, 7,9, 12,41, 21,46, 10,67, 2,27, 16,67, 3,57, 21,78, 0,21, 13,77, 24,51, 16,65, 2,74, 6,48, 15,35, 1,45, 6,35, 21,62, 2,5, 4,15, 17,72, 17,18, 4,18, 13,62, 1,19, 21,7, 21,48, 13,20, 15,56, 6,25, 17,77, 18,67, 8,32, 9,21, 0,15, 19,19, 21,21, 8,25, 1,33, 13,71, 10,27, 0,22, 9,9, 6,7, 8,75, 8,0, 11,63, 13,76, 20,14, 12,57, 14,16, 3,10, 2,30, 6,67, 6,28, 22,0, 20,3, 9,59, 2,68, 2,62, 16,64, 6,60, 8,78, 10,76, 19,43, 15,33, 4,62, 10,29, 11,54, 8,62, 22,29, 24,41, 0,28, 22,12, 22,72, 14,76, 17,11, 4,24, 7,0, 23,24, 8,27, 7,75, 22,28, 16,30, 22,65, 7,66, 7,60, 24,43, 24,75, 13,16, 8,72, 22,33, 22,24, 15,0, 1,40, 11,41, 9,12, 5,37, 2,43, 17,27, 19,34, 13,68, 12,4, 17,58, 16,9, 24,76, 6,76, 19,40, 0,66, 1,13, 15,22, 14,33, 19,57, 13,66, 4,26, 6,21, 17,56, 12,10, 2,75, 15,52, 23,79, 7,27, 14,68, 8,11, 13,6, 15,5, 7,71, 12,76, 23,55, 9,31, 0,56, 13,61, 14,35, 11,75, 12,49, 15,74, 1,34, 15,57, 4,51, 12,71, 14,64, 18,37, 13,1, 0,78, 19,62, 21,29, 9,27, 14,7, 22,75, 1,77, 4,22, 17,34, 8,3, 10,48, 1,51, 13,60, 14,50, 14,21, 7,37, 3,54, 11,30, 24,73, 14,37, 4,65, 6,64, 1,49, 5,26, 13,11, 2,79, 0,41, 5,29, 22,79, 20,32, 7,29, 0,4, 24,62, 18,49, 17,23, 22,70, 15,21, 18,56, 19,58, 3,56, 16,20, 24,37, 6,59, 23,54, 18,8, 19,56, 13,3, 17,43, 8,1, 0,48, 7,78, 16,73, 23,65, 3,22, 14,14, 19,9, 2,2, 20,39, 24,72, 19,66, 2,47, 17,22, 13,52, 0,55, 12,79, 2,44, 17,46, 0,74, 15,29, 6,63, 15,50, 24,30, 23,56, 3,38, 11,7, 13,58, 9,42, 21,10, 4,57, 21,74, 20,50, 11,20, 11,50, 0,68, 19,5, 22,63, 9,36, 21,73, 4,59, 6,52, 5,49, 2,59, 4,0, 7,58, 22,7, 20,29, 23,29, 9,64, 10,41, 16,49, 2,24, 5,31, 4,20, 21,41, 6,72, 6,0,
5,54, 15,51, 9,13, 15,11, 10,38, 15,48, 14,69, 11,15, 23,69, 11,42, 6,44, 11,40, 2,28, 14,55, 0,0, 0,58, 11,71, 10,43, 24,31, 8,6, 18,68, 24,66, 0,2, 15,63, 21,42, 11,39, 17,30, 8,4, 15,16, 23,41, 2,41, 8,60, 11,46, 3,19, 2,61, 4,72, 13,44, 13,63, 15,44, 10,30, 0,10, 16,60, 13,19, 11,74, 23,64, 4,73, 18,17, 13,33, 0,35, 24,42, 22,20, 23,19, 14,12, 2,39, 14,60, 14,75, 16,44, 18,36, 16,76, 13,51, 19,47, 16,15, 24,36, 11,1, 8,23, 14,45, 10,74, 6,41, 16,70, 13,24, 13,79, 22,61, 1,71, 24,2, 4,46, 11,52, 15,13, 1,27, 9,30, 15,68, 17,79, 12,18, 1,30, 5,13, 5,21, 20,63, 22,48, 22,41, 1,28, 4,16, 0,57, 9,6, 16,22, 3,43, 1,61, 23,15, 1,0, 18,40, 14,40, 19,78, 11,44, 11,29, 3,15, 0,9, 23,9, 0,44, 9,5, 2,46, 11,19, 21,8, 20,20, 6,20, 8,21, 0,71, 11,2, 14,74, 11,10, 10,11, 6,11, 9,35, 9,61, 16,28, 20,16, 3,71, 7,63, 5,66, 18,32, 4,33, 1,67, 22,37, 23,8, 12,29, 10,5, 1,57, 22,22, 6,17, 7,12, 4,50, 0,47, 5,1, 1,4, 14,18, 5,74, 22,67, 16,6, 7,16, 23,3, 7,67, 13,2, 24,12, 18,18, 12,25, 3,35, 18,34, 11,22, 9,29, 6,39, 2,32, 20,8, 20,67, 3,59, 15,27, 16,72, 14,31, 7,70, 14,56, 10,65, 8,76, 12,17, 4,17, 14,52, 24,48, 13,67, 9,37, 5,30, 12,11, 10,37, 23,58, 14,25, 16,71, 20,76, 2,34, 16,43, 17,39, 2,50, 20,21, 10,53, 9,38, 20,11, 9,50, 22,23, 8,41, 24,56, 10,32, 15,55, 5,55, 8,57, 15,61, 5,73, 6,38, 16,16, 22,60, 2,14, 13,5, 14,36, 21,50, 7,8, 0,30, 2,66, 4,2, 15,4, 22,10, 19,67, 13,54, 6,73, 24,8, 5,20, 14,41, 20,47, 24,17, 15,1, 23,30, 0,50, 19,36, 18,45, 5,6, 4,68, 13,28, 9,77, 15,73, 0,29, 18,21, 5,8, 0,77, 3,72, 9,32, 20,73, 8,34, 8,51, 3,13, 6,65, 13,39, 5,45, 14,62, 6,79, 5,3, 5,61, 3,75, 23,26, 7,54, 6,6, 4,64, 15,79, 23,13, 21,11, 10,26, 20,18, 12,64, 2,63, 6,8, 8,40, 10,54, 22,31, 17,33, 15,39, 14,51, 24,23, 23,59, 11,60, 19,68, 5,25, 7,20, 15,46, 20,78, 3,50, 11,21, 16,37, 19,28, 7,26, 23,33, 14,19, 8,24, 9,69, 5,43, 15,18, 10,15, 22,9, 19,44, 13,57, 24,65, 0,72, 7,65, 21,36, 4,75, 7,40, 14,58, 19,31, 3,32, 3,29, 13,46, 10,13, 11,59, 2,57, 2,22, 1,26, 13,43, 20,56, 1,32, 19,54, 23,38, 3,12, 17,3, 20,24, 7,49, 9,62, 0,36, 15,9, 15,36, 21,18, 5,33, 22,30, 9,74, 20,4, 20,48, 8,68, 20,55, 0,59, 17,69, 23,75, 17,76, 3,68,
1,3, 6,46, 15,12, 14,34, 12,50, 9,22, 19,35, 19,39, 8,70, 23,6, 6,2, 24,10, 3,0, 4,47, 6,1, 1,15, 7,17, 6,9, 11,56, 14,1, 0,8, 3,25, 10,79, 21,76, 16,52, 4,45, 2,3, 21,28, 10,61, 20,64, 24,28, 12,65, 12,1, 4,41, 14,30, 10,56, 16,32, 21,25, 13,12, 21,77, 10,69, 22,71, 1,42, 9,41, 17,49, 6,66, 19,14, 19,65, 10,78, 6,68, 21,44, 14,63, 17,40, 2,12, 2,18, 5,51, 22,5, 19,53, 11,70, 19,72, 23,25, 24,9, 9,19, 20,17, 23,47, 18,60, 3,77, 2,33, 9,65, 11,24, 16,18, 0,20, 11,36, 16,29, 14,20, 14,38, 12,12, 11,18, 10,36, 17,36, 19,38, 8,13, 11,35, 19,17, 12,63, 3,41, 24,11, 22,16, 11,16, 10,28, 21,40, 23,0, 0,34, 11,79, 6,18, 16,4, 18,31, 12,58, 13,17, 15,66, 2,4, 13,78, 1,66, 19,30, 7,21, 9,2, 6,43, 12,39, 6,31, 8,15, 1,38, 7,3, 12,53, 14,17, 7,36, 15,71, 2,29, 21,12, 2,0, 6,29, 1,74, 0,64, 1,5, 8,35, 20,25, 2,78, 12,9, 19,2, 8,63, 15,53, 10,35, 2,48, 2,37, 21,0, 19,24, 4,10, 14,44, 13,49, 7,46, 16,78, 2,45, 5,9, 0,7, 6,30, 20,49, 21,57, 0,31, 6,40, 1,18, 15,60, 22,47, 21,3, 13,31, 13,53, 17,21, 19,50, 7,6, 2,52, 7,72, 4,49, 15,30, 12,37, 0,25, 18,25, 4,28, 20,10, 13,45, 10,20, 10,22, 17,9, 3,78, 13,25, 18,1, 4,67, 2,77, 5,38, 19,11, 12,27, 6,34, 8,2, 6,27, 3,66, 2,69, 6,51, 4,71, 19,20, 13,72, 10,23, 21,75, 17,71, 21,56, 13,47, 17,61, 20,38, 8,55, 20,22, 12,0, 1,64, 9,71, 0,1, 1,22, 5,46, 21,47, 11,14, 5,67, 16,41, 9,28, 22,35, 15,72, 24,14, 8,26, 20,28, 21,55, 5,27, 9,54, 15,19, 5,28, 21,64, 2,8, 18,58, 16,50, 4,13, 12,2, 5,63, 14,54, 22,62, 5,78, 10,63, 5,53, 12,36, 6,58, 5,17, 17,67, 1,23, 22,17, 22,64, 13,64, 17,63, 9,56, 13,22, 22,77, 13,41, 5,57, 3,31, 24,71, 12,60, 15,69, 0,17, 11,62, 1,55, 3,51, 1,56, 12,45, 7,38, 22,34, 11,69, 23,37, 14,28, 21,5, 5,11, 13,59, 18,73, 24,25, 4,11, 12,73, 13,27, 19,45, 13,73, 8,73, 23,1, 21,22, 0,65, 2,67, 16,56, 5,36, 19,55, 6,70, 16,24, 22,68, 16,77, 9,40, 14,71, 22,1, 3,5, 15,25, 16,25, 15,70, 11,64, 12,14, 15,2, 22,74, 9,67, 8,67, 12,70, 7,59, 21,68, 14,29, 17,66, 5,12, 17,29, 17,6, 7,44, 8,14, 9,51, 0,26, 9,0, 3,23, 22,13, 7,51, 24,63, 2,65, 4,70, 1,21, 1,63, 15,17, 20,2, 19,27, 12,69, 9,63, 10,64, 18,62, 9,49, 1,73, 6,57, 2,54, 5,16, 7,45, 18,39, 13,8, 24,57, 15,78, 14,8, 1,7, 2,21, 8,9,
15,3, 3,14, 17,42, 10,31, 6,74, 6,75, 18,61, 7,11, 15,64, 18,51, 24,79, 10,34, 11,12, 16,17, 8,38, 21,34, 15,45, 0,53, 24,5, 11,33, 10,75, 1,24, 0,45, 7,42, 23,36, 4,53, 9,25, 15,65, 8,48, 13,55, 21,24, 19,41, 18,27, 11,58, 18,22, 0,37, 24,54, 15,34, 1,14, 23,72, 24,35, 16,68, 7,15, 24,33, 2,51, 24,55, 18,4, 16,12, 24,60, 15,37, 19,6, 5,32, 3,60, 0,76, 6,24, 4,42, 8,65, 17,44, 12,34, 5,52, 15,43, 20,58, 7,34, 24,13, 19,76, 12,43, 15,47, 9,20, 21,49, 7,4, 18,14, 5,70, 5,59, 12,61, 14,22, 14,67, 12,16, 9,18, 17,41, 11,77, 3,20, 1,46, 16,0, 18,53, 14,57, 18,77, 7,41, 1,53, 0,5, 12,19, 23,31, 6,54, 23,7, 7,25, 19,23, 18,12, 23,16, 13,38, 17,73, 5,18, 13,74, 21,58, 2,76, 5,22, 12,66, 22,25, 5,0, 8,12, 24,4, 20,70, 0,54, 21,4, 12,31, 2,40, 22,4, 24,38, 5,72, 3,34, 21,66, 18,71, 1,1, 7,30, 14,46, 13,13, 7,77, 23,74, 8,49, 16,48, 10,39, 5,42, 4,5, 19,4, 5,14, 19,71, 4,56, 21,79, 11,53, 5,24, 16,40, 14,2, 5,41, 13,21, 1,41, 22,51, 18,57, 20,42, 21,69, 11,48, 20,33, 24,52, 0,14, 1,78, 1,39, 9,55, 10,62, 3,37, 14,43, 24,58, 4,52, 15,77, 9,14, 18,0, 10,6, 18,42, 22,2, 24,64, 11,32, 18,54, 2,36, 17,51, 13,42, 16,13, 21,61, 18,52, 20,57, 20,68, 22,45, 16,10, 8,10, 8,46, 7,56, 23,12, 12,78, 19,29, 1,31, 4,74, 7,76, 21,37, 10,7, 3,46, 19,26, 19,3, 10,9, 3,65, 15,28, 15,32, 12,33, 9,78, 22,6, 22,27, 1,62, 24,15, 1,29, 21,23, 12,7, 11,66, 19,25, 23,57, 11,27, 16,11, 3,74, 16,7, 20,31, 7,68, 23,43, 0,18, 7,5, 17,12, 16,27, 20,69, 9,3, 16,75, 14,6, 15,15, 5,47, 7,7, 2,11, 8,20, 8,33, 17,60, 5,35, 22,50, 20,61, 19,51, 19,32, 8,45, 23,35, 11,25, 12,24, 23,53, 22,36, 0,61, 14,0, 21,54, 23,18, 19,59, 1,11, 17,50, 15,23, 4,35, 17,31, 3,53, 0,33, 7,62, 14,72, 3,49, 21,9, 10,2, 24,20, 24,68, 9,57, 17,45, 7,33, 18,15, 4,23, 1,36, 16,46, 11,4, 14,66, 9,70, 11,17, 21,26, 13,36, 21,35, 20,35, 19,63, 5,34, 21,20, 18,29, 13,29, 24,53, 21,1, 12,47, 16,47, 5,23, 19,13, 14,47, 16,2, 6,42, 8,37, 20,71, 3,36, 24,18, 6,16, 20,7, 8,64, 8,19, 16,69, 11,8, 17,28, 18,28, 3,45, 6,45, 15,42, 17,78, 7,23, 18,48, 4,79, 13,7, 3,52, 16,19, 20,54, 24,39, 6,78, 14,70, 8,50, 3,79, 6,22, 11,76, 16,57, 23,4, 5,7, 8,69, 13,9, 21,2, 24,49, 11,65, 12,62,
4,14, 23,44, 1,6, 10,44, 18,74, 9,8, 17,7, 24,0, 8,54, 2,26, 10,46, 5,40,
4,69, 21,19, 13,4, 19,15, 23,11, 5,65, 13,14, 0,60, 24,40, 10,50, 5,75, 10,68, 23,66, 7,64, 17,32, 0,51, 8,36, 8,58, 2,1, 24,3, 1,2, 6,5, 21,14, 15,58, 10,47, 16,38, 12,5, 1,75, 7,1, 19,69, 16,74, 22,15, 17,38, 7,35, 6,53, 4,29, 17,62, 21,60, 22,52, 23,10, 11,26, 21,33, 17,10, 10,72, 18,3, 0,12, 18,64, 18,6, 9,24, 1,72, 22,78, 4,4, 12,77, 22,42, 19,61, 15,7, 9,44, 11,38, 8,39, 18,20, 3,58, 11,5, 22,69, 20,13, 6,62, 12,72, 15,14, 17,48, 20,19, 9,75, 20,6, 11,73, 22,58, 24,74, 0,75, 10,51, 16,26, 1,76, 14,73, 23,61, 18,13, 20,37, 4,76, 21,39, 7,69, 20,62, 0,23, 19,16, 16,63, 20,65, 19,79, 13,70, 22,40, 11,72, 8,53, 17,20, 3,27, 22,32, 9,52, 3,40, 17,8, 23,77, 4,66, 23,22, 18,70, 20,74, 4,19, 24,77, 17,19, 9,17, 18,46, 13,34, 12,6, 21,65, 1,47, 12,13, 7,43, 2,64, 20,51, 17,24, 12,46, 7,28, 3,76, 10,52, 22,39, 11,49, 20,36, 9,47, 6,19, 1,16, 22,14, 24,50, 23,50, 1,35, 9,43, 22,56, 5,50, 17,47, 18,79, 0,63, 5,76, 8,17, 24,22, 13,35, 1,54, 3,7, 17,74, 2,31, 14,10, 13,10, 12,21, 16,23, 15,10, 11,55, 17,75, 4,31, 23,42, 3,69, 8,29, 22,76, 2,49, 7,18, 2,55, 5,60, 3,26, 1,25, 12,32, 5,71, 3,48, 0,49, 24,21, 3,4, 2,53, 14,24, 20,23, 20,53, 16,5, 0,43, 0,11, 8,77, 4,32, 21,52, 22,49, 22,21, 24,70, 20,79, 21,63, 22,66, 18,55, 10,21, 18,63, 6,10, 9,4, 12,23, 22,38, 11,47, 14,48, 18,44, 9,33, 7,19, 4,48, 17,37, 10,70, 16,42, 16,58, 0,38, 4,8, 0,42, 10,55, 23,68, 7,79, 23,49, 24,44, 24,1, 6,36, 1,17, 19,21, 16,54, 9,53, 20,26, 3,39, 12,38, 11,45, 3,70, 12,8, 1,12, 18,47, 10,57, 7,13, 4,38, 24,19, 6,15, 19,22, 13,30, 24,47, 1,8, 19,37, 2,72, 1,52, 4,30, 7,57, 23,20, 24,24, 22,18, 18,7, 6,26, 24,59, 9,48, 8,28, 14,11, 9,23, 13,75, 9,46, 2,71, 23,71, 16,66, 19,70, 12,75, 12,55, 13,50, 9,68, 2,13, 15,75, 15,49, 10,49, 6,69, 23,32, 20,45, 24,32, 22,11, 5,64, 24,45, 19,74, 20,1, 6,13, 13,40, 2,35, 20,72, 12,74, 11,61, 16,3, 8,18, 16,36, 0,3, 15,8, 14,65, 2,23, 13,69, 8,71, 22,46, 21,70, 8,44, 12,56, 12,3, 11,28, 17,0, 4,9, 3,55, 19,12, 6,12, 15,41, 3,2, 5,79, 16,1, 24,26, 12,42, 15,59, 2,56, 14,15, 7,14, 10,19, 4,55, 18,26, 5,69, 11,11, 17,13, 19,64, 14,53, 16,53, 11,6, 1,44, 20,77, 18,78, 10,10, 2,17, 13,15, 2,16, 15,20, 15,62, 7,50, 3,1,
} ;

/*---------------------------------------
*	matrix of random characters to use as 
*	"garbage" simulating initial encryption.
*	I created the preceeding random-fill matrix the easy way: a
*	nested-loop counter in Perl produced a sequential file of all 
*	possible screen coordinates of an 80 x 25 screen, then I ran
*	that file through my unsort program, and stored the result.
---------------------------------------*/

	char rchars[] = "1234567890-=!@#$%&**()_+~`qwertyuiop[]\asdfghjkl;'zxcvbnm,./QWERTYUIUIOP{}|ASDFGHJKL:ZXCVBNM<>?}'" ;
	FILE * ifp ;
	int LINES = 24 ;
	unsigned int linecounter, col ;
	int digit_optind = 0;
	int GARBAGE = 0 , i, j, c, d, p, tabcount, line[25][81] , rchars_len ;

	rchars_len   = strlen(rchars) ;	/* size of garbage source array */
	LINES=atoi(getenv("LINES")) ;
	//printf("LINES: %d\n", LINES) ;
	if ( 3 > LINES) LINES = 24 ;

	/*-------------------
	*	no switch, used in pipe or with '<'
	-------------------*/
	if(argc == 1 ) 
	{
		c = 'f' ;
		ifp = stdin ;
		goto start_switch ;
	}
	/*--------------------
	*	getopt processing
	--------------------*/
	while (1)
	{
		int this_option_optind = optind ? optind : 0;
		int option_index = 0;
		static struct option long_options[] =
		{
			{"nofog", 	0, 0, 'n' },
			{"fog", 	0, 0, 'f' },
			{"help", 	0, 0, 'h' },
			{0, 0, 0, 0} 	/* last rec must be all zeroes */
		} ;
		
		if (argc < 1 )
		{
			c = 'f' ;
			goto start_switch ;
		}
	
		c = getopt_long (argc, argv, "nfh", long_options, &option_index);

		// (it _will_ get here once it's processed getopts)
		if (c == -1 )
		{
			break;  // exit while loop
		}
		start_switch:
		switch (c)
		{
			case 'f':
				GARBAGE = 1 ;
				if (NULL == (ifp = fopen (argv[2], "r") ))
					ifp=stdin ;
			break ;

			case 'n':
				GARBAGE = 0 ;
				if (NULL == (ifp = fopen(argv[2], "r") ))
					ifp=stdin ;
		//		printf("set file stream\n") ;
			break ;

			case 'h':
				printf("FOG -[nfh]\n\"Foggy More\" by T. E. Harrisburg.\nFoggy text display, see opening credits to \"Sneakers.\"\n-f/--fog  -n/--nofog  -h/--help\n") ;
				exit(0) ;
			break;
	
			default:
				if (NULL == (ifp = fopen(argv[1], "r") )) // needs fixing here
					if (NULL == (ifp = fopen(argv[2], "r") )) // needs fixing here
						ifp=stdin ;
				fflush(stdout) ;
				goto begin_init ;
			break ;
		} /* switch */
} /* while */
//	if (optind < argc)
//	{
	//	printf ("non-option ARGV-elements: ");
	//	while (optind < argc)
	//		printf ("%s ", argv[optind++]);
	//	printf ("\n");
//	}


	/*---------------------------
	*	start Curses.
	---------------------------*/
begin_init: initscr() ;
	linecounter = col = 0 ;
	while( !(feof(ifp))  ) 
	{
		/*--------------------------
		*	clear out screen array
		--------------------------*/
		for (i = 0 ; i < 25 ; i++)
			for (j = 0 ; j < 80 ; j++)
				line[i][j] = ' ' ;
		if (GARBAGE)
		{
			/*-----------------------
			*	fill screen with gibberish.
			-----------------------*/
			for (i = 0 ; i < 25 ; i++)
			{
				for (j = 0 ; j < 80 ; j++)
				{
					move(i, j) ; 
					c = ( (int ) rand() ) % rchars_len ;
					addch(rchars[c]) ; 
				}
				move (i,80) ;
				addch(' ') ;
				move (25,0) ; 		/* park it */
			if(!(i % 2)) usleep(SLEEPTIME) ; 
			refresh() ;
			}
		//	if(!(i % 2)) usleep(SLEEPTIME) ; 
		//	refresh() ;
		} /* if GARBAGE */
		/*----------------------------
		*	fill page in memory with text from input stream
		----------------------------*/
		for (i = 0 ; i < 25  ; i++)
		{
			for (j = 0 ; j < 80  ; j++)
			{
				p = fgetc(ifp) ;
				if ( feof(ifp) )
					break ;
				if (p == '\t') 
					for (tabcount = 0 ; tabcount < 8 ; tabcount++)
						line[i][j++] = ' ' ;
				else 
				if ( p != '\n' && p != '\r')
					line[i][j] = p ;
				else
					break ;
			}
			if ( feof(ifp) )
				break ;
		}
		c = 0  ;
		/*---------------------------
		*	transfer memory image to screen
		--------------------------*/
		for ( c = 0 ; c < 4000 ; c++)
		{
			move(coords[c],coords[c + 1]) ; 
			addch(line[ coords[c] ] [ coords[c+1] ]) ;
			if(!(c % 500)) fracsleep(SLEEPTIME) ;
			refresh() ;
			if (++c >= 4000) break ;
		}
		/*-----------------------
		*	pause to read screen 
		-----------------------*/
		move (26,0) ; 
		refresh() ;
		fflush(stdin) ;
		sleep(3) ; 
	/*	getchar() ; */
	} 
	fclose(ifp) ;
	die(0) ;
} /* main ends */

void die(int arg)
{
	signal (SIGINT, SIG_IGN) ;
	mvcur(0, 80 -1, 25 - 1, 0 ) ;
	endwin() ;
	exit(arg) ;
}



/*-----------------------------------------------------------------
*	ftacsleep.c	-	sleep for fractions of a second
Sat Nov  1 10:06:06 PST 2003
-----------------------------------------------------------------*/
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <ctype.h>
#include <time.h>

int fracsleep (int millisecs) 
{
	clock_t now, start, stop ;
	start = clock() ;
	stop = start + millisecs * 1000 ;
	while( (now = clock()) <  stop)
		{;}

}

